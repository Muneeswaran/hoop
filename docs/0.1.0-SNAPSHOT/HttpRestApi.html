<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Jul 22, 2011 -->
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Hoop - Hoop, Hadoop HDFS over HTTP 0.1.0-SNAPSHOT - HTTP REST API</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
        <meta name="author" content="Alejandro Abdelnur" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      </head>
  <body class="composite">
    <div id="banner">
                  <span id="bannerLeft">
                Â 
                </span>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                                <div class="xleft">
        Last Published: 2011-07-22
                      </div>
            <div class="xright">            <a href="../index.html">OTHER RELEASES</a>
            |
                <a href="http://www.cloudera.com/" class="externalLink">Cloudera</a>
              
                                 Version: 0.1.0-SNAPSHOT
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                                                          <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
          <img alt="Built by Maven" src="./images/logos/maven-feather.png"/>
        </a>
                       
                            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Hoop, Hadoop HDFS over HTTP 0.1.0-SNAPSHOT - HTTP REST API</h2>
<p>[ <a href="index.html">Go Back</a> ]</p>
<div class="section"><h3>Security</h3>
<p>Hoop enforces authentication using <a class="externalLink" href="http://github.com/cloudera/alfredo">Alfredo</a>. Out of the box Alfredo supports both pseudo authentication and Kerberos HTTP SPNEGO authentication.</p>
<div class="section"><h4>Pseudo Authentication</h4>
<p>With pseudo authentication the user name must be specified in the <tt>user.name=&lt;USERNAME&gt;</tt> query string parameter of a Hoop URL. For example:</p>
<div class="source"><pre>$ curl &quot;http://&lt;HOOP_HOST&gt;:14000?op=homedir&amp;user.name=babu&quot;</pre>
</div>
</div>
<div class="section"><h4>Kerberos HTTP SPNEGO Authentication</h4>
<p>Kerberos HTTP SPENGO authentication requires a tool or library supporting Kerberos HTTP SPNEGO protocol.</p>
<p>IMPORTANT: If using <tt>curl</tt>, the <tt>curl</tt> version being used must support GSS (<tt>curl -V</tt> prints out 'GSS' if it supports it).</p>
<p>For example:</p>
<div class="source"><pre>$ kinit
Please enter the password for tucu@LOCALHOST:
$ curl --negotiate -u foo &quot;http://&lt;HOOP_HOST&gt;:14000?op=homedir&quot;
Enter host password for user 'foo':</pre>
</div>
<p>NOTE: the <tt>-u USER</tt> option is required by the <tt>--negotiate</tt> but it is not used. Use any value as <tt>USER</tt> and when asked for the password press [ENTER] as the password value is ignored.</p>
</div>
<div class="section"><h4><a name="Remembering_Who_I_Am">Remembering Who I Am</a> (Establishing an Authenticated Session)</h4>
<p>As most authentication mechanisms, Alfredo authenticates users once and issues a short-lived authentication token to be presented in subsequent requests. This authentication token is a signed HTTP Cookie.</p>
<p>When using tools like <tt>curl</tt>, the authentication token must be stored on the first request doing authentication, and submitted in subsequent requests. To do this with curl the <tt>-b</tt> and <tt>-c</tt> options to save and send HTTP Cookies must be used.</p>
<p>For example, the first request doing authentication should save the received HTTP Cookies.</p>
<p>Using Pseudo Authentication:</p>
<div class="source"><pre>$ curl -b ~/.hoopauth &quot;http://&lt;HOOP_HOST&gt;:14000?op=homedir&amp;user.name=babu&quot;</pre>
</div>
<p>Using Kerberos HTTP SPNEGO authentication:</p>
<div class="source"><pre>$ curl --negotiate -u foo -b ~/.hoopauth &quot;http://&lt;HOOP_HOST&gt;:14000?op=homedir&quot;</pre>
</div>
<p>Then, subsequent requests forward the previously received HTTP Cookie:</p>
<div class="source"><pre>$ curl -c ~/.hoopauth &quot;http://&lt;HOOP_HOST&gt;:14000?op=list&quot;</pre>
</div>
</div>
</div>
<div class="section"><h3>File System Operations</h3>
<p>The HTTP REST API is fully demonstrated below using the Unix <tt>curl</tt> command.</p>
<p>HOOP HTTP status codes follow HTTP guidelines.</p>
<p>HOOP payload responses are in JSON format.</p>
<p>For optional parameters, the default values are between '*', for example 'overwrite=*true*|false'.</p>
<p>All the Examples below assume the User is already already authenticated, refer to the <a href="#Remembering_Who_I_Am">Remembering Who I Am</a> section.</p>
<div class="section"><h4>Read File</h4>
<p>HTTP Request:</p>
<div class="source"><pre>$ curl -X GET -c ~/.hoopauth &quot;http://&lt;HOOP_HOST&gt;:14000/&lt;PATH&gt;[?&lt;OPTION&gt;[&amp;&lt;OPTION&gt;]*]&quot;</pre>
</div>
<p>OPTIONS:</p>
<ul><li>offset=*-1*|&lt;LONG&gt; ('-1' means the whole file)</li>
<li>len=*-1*|&lt;LONG&gt; ('-1' means from the beginning of the file)<p>Sucessful HTTP Response:</p>
<div class="source"><pre>HTTP/1.1 200 OK
Location: http://&lt;HOOP_HOST&gt;:14000/PATH
Content-Type: application/octet-stream
Transfer-Encoding: chunked

&lt;FILE CONTENTS&gt;</pre>
</div>
</li>
</ul>
</div>
<div class="section"><h4>Write File</h4>
<p>HTTP Request:</p>
<div class="source"><pre>$ curl -X POST -c ~/.hoopauth &quot;http://&lt;HOOP_HOST&gt;:14000/&lt;PATH&gt;?op=create[&amp;&lt;OPTION&gt;]*&quot; \
  --data-binary @data.txt  --header &quot;content-type: application/octet-stream&quot;</pre>
</div>
<p>OPTIONS:</p>
<ul><li>overwrite=*true*|false</li>
<li>replication=*-1*|&lt;SHORT&gt;</li>
<li>blocksize=*-1*|&lt;LONG&gt;</li>
<li>permission=*default*|&lt;-rwxrwxrw&gt;<p>The content-type header must be specified othewise <tt>curl</tt> will use <tt>application/x-www-form-urlencoded</tt> and the servlet-container will attempt parsing the inputstream as a form POST.</p>
<p>Sucessful HTTP Response:</p>
<div class="source"><pre>HTTP/1.1 201 Created
Location: http://&lt;HOOP_HOST&gt;:14000/PATH
Content-Type: application/json
Content-Length: 0
</pre>
</div>
</li>
</ul>
</div>
<div class="section"><h4>Append File</h4>
<p>HTTP Request:</p>
<div class="source"><pre>$ curl -X PUT -c ~/.hoopauth &quot;http://&lt;HOOP_HOST&gt;:14000/&lt;PATH&gt;?op=append&quot; \
  --data-binary @data.txt --header &quot;content-type: application/octet-stream&quot;</pre>
</div>
<p>The content-type header must be specified othewise <tt>curl</tt> will use <tt>application/x-www-form-urlencoded</tt> and the servlet-container will attempt parsing the inputstream as a form POST.</p>
<p>Sucessful HTTP Response:</p>
<div class="source"><pre>HTTP/1.1 200 OK
Location: http://&lt;HOOP_HOST&gt;:14000/PATH
Content-Type: application/json
Content-Length: 0
</pre>
</div>
</div>
<div class="section"><h4>Rename File/Directory</h4>
<p>HTTP Request:</p>
<div class="source"><pre>$ curl -X PUT -c ~/.hoopauth &quot;http://&lt;HOOP_HOST&gt;:14000/&lt;OLDPATH&gt;?op=rename&amp;to=&lt;NEWPATH&gt;&quot;</pre>
</div>
<p>Sucessful HTTP Response:</p>
<div class="source"><pre>HTTP/1.1 200 OK
Content-Type: application/json
Transfer-Encoding: chunked

{&quot;rename&quot;:true}</pre>
</div>
</div>
<div class="section"><h4>Delete File/Directory</h4>
<p>HTTP Request:</p>
<div class="source"><pre>$ curl -X DELETE -c ~/.hoopauth \
  &quot;http://&lt;HOOP_HOST&gt;:14000/&lt;PATH&gt;?op=delete[&amp;recursive=*true*|false]&quot;</pre>
</div>
<p>Sucessful HTTP Response:</p>
<div class="source"><pre>HTTP/1.1 200 OK
Content-Type: application/json
Transfer-Encoding: chunked

{&quot;delete&quot;:true}</pre>
</div>
</div>
<div class="section"><h4>List Directory</h4>
<p>HTTP Request:</p>
<div class="source"><pre>$curl -X GET -c ~/.hoopauth &quot;http://&lt;HOOP_HOST&gt;:14000/&lt;PATH&gt;?op=list[&amp;filter=&lt;FILTER&gt;]&quot;</pre>
</div>
<p>If specifying a filter use Hadoop's GlobFilter syntax.</p>
<p>Sucessful HTTP Response:</p>
<div class="source"><pre>HTTP/1.1 200 OK
Content-Type: application/json
Transfer-Encoding: chunked

[
  {
    &quot;path&quot; : &quot;http:\/\/&lt;HOOP_HOST&gt;:14000\/&lt;PATH&gt;\/foo.txt&quot;
    &quot;isDir&quot; : false,
    &quot;len&quot; : 966,
    &quot;owner&quot; : &quot;babu&quot;,
    &quot;group&quot; : &quot;supergroup&quot;,
    &quot;permission&quot; : &quot;-rw-r--r--&quot;,
    &quot;accessTime&quot; : 1310671662423,
    &quot;modificationTime&quot; : 1310671662423,
    &quot;blockSize&quot; : 67108864,
    &quot;replication&quot; : 3
  }
]</pre>
</div>
</div>
<div class="section"><h4>Make Directory</h4>
<p>HTTP Request:</p>
<div class="source"><pre>$ curl -X POST -c ~/.hoopauth \
  &quot;http://&lt;HOOP_HOST&gt;:14000/&lt;PATH&gt;?op=mkdirs[&amp;permission=*default*|&lt;-rwxrwxrw&gt;]&quot;</pre>
</div>
<p>Sucessful HTTP Response:</p>
<div class="source"><pre>HTTP/1.1 200 OK
Content-Type: application/json
Transfer-Encoding: chunked

{&quot;mkdirs&quot;:true}</pre>
</div>
</div>
<div class="section"><h4>File Status</h4>
<p>HTTP Request:</p>
<div class="source"><pre>$ curl -X GET -c ~/.hoopauth &quot;http://&lt;HOOP_HOST&gt;:14000/&lt;PATH&gt;?op=status&quot;</pre>
</div>
<p>Sucessful HTTP Response:</p>
<div class="source"><pre>HTTP/1.1 200 OK
Content-Type: application/json
Transfer-Encoding: chunked

{
  &quot;path&quot; : &quot;http:\/\/&lt;HOOP_HOST&gt;:14000\/&lt;PATH&gt;&quot;
  &quot;isDir&quot; : false,
  &quot;len&quot; : 966,
  &quot;owner&quot; : &quot;babu&quot;,
  &quot;group&quot; : &quot;supergroup&quot;,
  &quot;permission&quot; : &quot;-rw-r--r--&quot;,
  &quot;accessTime&quot; : 1310671662423,
  &quot;modificationTime&quot; : 1310671662423,
  &quot;blockSize&quot; : 67108864,
  &quot;replication&quot; : 3
}</pre>
</div>
</div>
<div class="section"><h4>Home Directory</h4>
<p>HTTP Request:</p>
<div class="source"><pre>$ curl -X GET -c ~/.hoopauth &quot;http://&lt;HOOP_HOST&gt;:14000/?op=homedir&quot;</pre>
</div>
<p>Sucessful HTTP Response:</p>
<div class="source"><pre>HTTP/1.1 200 OK
Content-Type: application/json
Transfer-Encoding: chunked

{&quot;homeDir&quot;:&quot;http:\/\/&lt;HOOP_HOST&gt;:14000\/user\/babu&quot;}</pre>
</div>
</div>
<div class="section"><h4>Set Owner</h4>
<p>HTTP Request:</p>
<div class="source"><pre>$ curl -X PUT -c ~/.hoopauth \
  &quot;http://&lt;HOOP_HOST&gt;:14000/&lt;OLDPATH&gt;?op=setowner&amp;owner=&lt;OWNER&gt;&amp;group=&lt;GROUP&gt;&quot;</pre>
</div>
<p>If 'owner' or 'group' are not specified, the current value is preserved.</p>
<p>Sucessful HTTP Response:</p>
<div class="source"><pre>HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 0
</pre>
</div>
</div>
<div class="section"><h4>Set Permission</h4>
<p>HTTP Request:</p>
<div class="source"><pre>$ curl -X PUT -c ~/.hoopauth \
  &quot;http://&lt;HOOP_HOST&gt;:14000/&lt;PATH&gt;?op=setpermission&amp;permission=*default*|&lt;-rwxrwxrw&gt;&quot;</pre>
</div>
<p>Sucessful HTTP Response:</p>
<div class="source"><pre>HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 0
</pre>
</div>
</div>
<div class="section"><h4>Set Times</h4>
<p>HTTP Request:</p>
<div class="source"><pre>$ curl -X PUT -c ~/.hoopauth \
  &quot;http://&lt;HOOP_HOST&gt;:14000/&lt;PATH&gt;?op=settimes&amp;mtime=&lt;LONG&gt;&amp;atime=&lt;LONG&gt;&quot;</pre>
</div>
<p>If 'mtime' or 'atime' are not specified, the current value is preserved.</p>
<p>Sucessful HTTP Response:</p>
<div class="source"><pre>HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 0
</pre>
</div>
</div>
<div class="section"><h4>Set Replication</h4>
<p>HTTP Request:</p>
<div class="source"><pre>$ curl -X PUT -c ~/.hoopauth \
  &quot;http://&lt;HOOP_HOST&gt;:14000/&lt;PATH&gt;?op=setreplication&amp;replication=&lt;SHORT&gt;&quot;</pre>
</div>
<p>If 'replication' is not set the default value is used.</p>
<p>Sucessful HTTP Response:</p>
<div class="source"><pre>HTTP/1.1 200 OK
Content-Type: application/json
Transfer-Encoding: chunked

{&quot;setReplication&quot;:true}</pre>
</div>
</div>
<div class="section"><h4>File System Command Failures</h4>
<p>A failed Hoop file system command produces a detailed response in JSON besides the HTTP error code, for example:</p>
<div class="source"><pre>HTTP/1.1 500 Internal Server Error
Content-Type: application/json
Transfer-Encoding: chunked
Connection: close

{
  &quot;statusCode&quot;:500,
  &quot;reason&quot;:&quot;Internal Server Error&quot;,
  &quot;message&quot;:&quot;H03: FileSystemExecutor error, ...: Non-super user cannot change owner.&quot;,
  &quot;exception&quot;:&quot;HadoopException&quot;
}</pre>
</div>
<p>[ <a href="index.html">Go Back</a> ]</p>
</div>
</div>
</div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;            2011
              Cloudera
            
                       - <a href="http://maven.apache.org/privacy-policy.html">Privacy Policy</a></div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
